<div class="row">
    <button data-bind="click: openMessage, disable: isOpen" type="button" class="btn btn-default">New Message</button>
</div>

<div data-bind="page: {id: 'start'}">
    <div class="row">
        <ul data-bind="foreach: messages">
            <li>
                <div class="message" data-bind="attr: {id: 'message_' + id}">
                    <input type="hidden" data-bind="value: id" />
                    <div class="message-header">
                        <a data-bind="page-href: {path: '../details', params: {name: name, id: id}}">@@<span data-bind="text: name"></span></a>
                    </div>
                    <div data-bind="text: text"></div>
                    <div class="message-footer">
                        <a data-bind="click: $root.deleteMessage" class="delete "href="#">Delete</a> | <a href="#">Reply</a>
                    </div>
                    <br style="clear: both"/>
                </div>
            </li>
        </ul>
    </div>
</div>

<div data-bind="page: {id: 'details', params: ['name','id'], afterShow: loadDetails}">
    <a data-bind="page-href: '../start'">start</a>
    <!-- ko if: $root.details -->
    <!-- ko with: $root.details -->
    <div class="message" data-bind="attr: {id: 'message_' + id}">
        <input type="hidden" data-bind="value: id" />
        <div class="message-header">
            <a data-bind="page-href: {path: '../details', params: {name: name, id: id}}">@@<span data-bind="text: name"></span></a>
        </div>
        <div data-bind="text: text"></div>
        <div class="message-footer">
            <a data-bind="click: $root.deleteMessage" class="delete "href="#">Delete</a> | <a href="#">Reply</a>
        </div>
        <br style="clear: both"/>
    </div>
    <!-- /ko -->
    <ul data-bind="foreach: replies">
        <li>
            <span data-bind="text: name"></span>
        </li>
    </ul>
    <!-- /ko -->
</div>

<div class="new-message" data-bind="dialog: { isOpen: isOpen, title: 'New Message', minWidth: 400, minHeight: 200 }">
    <textarea data-bind="value: message, valueUpdate: 'input'"></textarea>
    <div>
        <button data-bind="enable: canSend(), click: sendMessage">Send</button>
        <label data-bind="text: getCharacterCount(), style:{color: canSend() ? 'green' : 'red'} "></label>
    </div>
</div>